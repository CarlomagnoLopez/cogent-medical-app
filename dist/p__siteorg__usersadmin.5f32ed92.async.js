(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"lsb+":function(e,t,a){"use strict";a.r(t);var r=a("jrin"),n=(a("T2oS"),a("W9HT")),o=(a("IzEo"),a("bx4M")),l=(a("g9YV"),a("wCAj")),s=(a("miYZ"),a("tsqr")),i=(a("DYRE"),a("zeV3")),c=(a("+L6B"),a("2/Rp")),u=(a("5NDa"),a("5rEg")),p=a("fWQN"),d=a("mtLc"),m=a("tS8v"),h=a("yKVA"),g=a("879j"),f=(a("2qtc"),a("kLXV")),v=a("q1tI"),b=a.n(v),y=a("0Owb"),E=(a("DZo9"),a("8z0m")),C=(a("OaEy"),a("2fM7")),S=(a("O3gP"),a("lrIw")),O=(a("y8nQ"),a("Vl3Y")),I=(a("2HEe"),a("vDqi"),O["a"].Item,c["a"].Group,S["a"].Option,C["a"].Option),U=(E["a"].Dragger,""),w=function(e){Object(h["a"])(a,e);var t=Object(g["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),r.onFinish=function(e){e.phoneNumber="+"+e.prefix+e.phoneNumber,console.log("Received values of form: ",JSON.stringify(e)),r.props.createUser(e)},r.handleSearch=function(e){r.setState({loadingcompanies:!0}),e||r.setState({data:[]})},r.onRoleChange=function(e){},r.handleChange=function(e){r.setState({value:e})},r.prefixSelector=b.a.createElement(O["a"].Item,{name:"prefix",noStyle:!0},b.a.createElement(C["a"],{style:{width:70}},b.a.createElement(I,{value:"1"},"+1"),b.a.createElement(I,{value:"86"},"+86"),b.a.createElement(I,{value:"87"},"+87"),b.a.createElement(I,{value:"91"},"+91"),b.a.createElement(I,{value:"55"},"+55"),b.a.createElement(I,{value:"52"},"+52"))),r.state={data:[],value:"hi",loadingcompanies:!1},console.log("Constructor Calling"),r}return Object(d["a"])(a,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(){console.log("Componenet Will Receive Props")}},{key:"render",value:function(){var e=this,t={required:"${label} is required!",types:{email:"${label} is not validate email!",number:"${label} is not a validate number!"},number:{range:"${label} must be between ${min} and ${max}"}},a=C["a"].Option;console.log(this.props.data),"orgadmin"===localStorage.getItem("currentAuth")&&(U=this.props.data.filter((function(e){return e["mcp-1-pk"]===localStorage.getItem("orgid")})),console.log("Org Name . "+JSON.stringify(U)));var r=void 0!=this.props.data?this.props.data.map((function(e){return b.a.createElement(a,{value:e[0]},e.orgname)})):"",n={labelCol:{span:8},wrapperCol:{span:16}};return b.a.createElement(f["a"],{closable:!0,visible:this.props.visible,title:"Create User",cancelText:"Cancel",footer:null,destroyOnClose:!0,onCancel:this.props.onCancel},b.a.createElement(O["a"],Object(y["a"])({},n,{ref:function(t){return e.formRef=t},onFinish:this.onFinish,validateMessages:t,initialValues:{prefix:"91"}}),b.a.createElement(O["a"].Item,{label:"CompanyName",name:"orgid",hasFeedback:this.state.loadingcompanies,rules:[{required:!0}]},b.a.createElement(C["a"],{required:!0,showSearch:!0,value:this.state.value,placeholder:"companyName",style:{width:"100%"},defaultActiveFirstOption:!1,showArrow:!1,filterOption:function(e,t){return t.value.toLowerCase().indexOf(e.toLowerCase())>=0},onSearch:this.handleSearch,onChange:this.handleChange,notFoundContent:null},r)),b.a.createElement("p",null),b.a.createElement(O["a"].Item,{name:"role",label:"Role",rules:[{required:!0}]},b.a.createElement(C["a"],{placeholder:"Select a role",onChange:this.onRoleChange,allowClear:!0},b.a.createElement(a,{value:"User"},"User"),b.a.createElement(a,{value:"OrgAdmin"},"OrgAdmin"),b.a.createElement(a,{value:"OrgApproval"},"OrgApprover"))),b.a.createElement(O["a"].Item,{label:"Contact Name",name:"name",rules:[{required:!0}]},b.a.createElement(u["a"],{placeholder:"Contact Name",id:"error"})),b.a.createElement(O["a"].Item,{label:"Contact Email",name:"email",rules:[{required:!0,type:"email"}]},b.a.createElement(u["a"],{placeholder:"Contact Email",id:"error"})),b.a.createElement(O["a"].Item,{label:"Contact Number",name:"phoneNumber",rules:[{required:!0,asyncValidator:function(e,t){return new Promise((function(e,a){isNaN(t)?a("It does not accept this value"):e()}))}}]},b.a.createElement(u["a"],{addonBefore:this.prefixSelector,placeholder:"Contact Number",maxLength:10})),b.a.createElement(O["a"].Item,{wrapperCol:{span:16,offset:20}},b.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"Submit"))))}}]),a}(v["Component"]),A=w,k=(O["a"].Item,c["a"].Group,S["a"].Option,C["a"].Option),x=(E["a"].Dragger,function(e){Object(h["a"])(a,e);var t=Object(g["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),r.onFinish=function(e){console.log("Received values of form: ",e),e.userName=r.props.current["mcp-1-sk"],r.props.updateUser(e)},r.prefixSelector=b.a.createElement(O["a"].Item,{name:"prefix",noStyle:!0},b.a.createElement(C["a"],{style:{width:70}},b.a.createElement(k,{value:"86"},"+86"),b.a.createElement(k,{value:"87"},"+87"),b.a.createElement(k,{value:"91"},"+91"),b.a.createElement(k,{value:"55"},"+55"),b.a.createElement(k,{value:"1"},"+1"),b.a.createElement(k,{value:"52"},"+52"))),r.handleSearch=function(e){console.log("Value "+e),r.setState({loadingcompanies:!0}),e||r.setState({data:[]})},r.onRoleChange=function(e){},r.handleChange=function(e){console.log("Handle Change "+e),r.setState({value:e})},r.state={current:"",value:""},r}return Object(d["a"])(a,[{key:"setPhone",value:function(e){if(""!==e&&e){var t="";return t=0===e.indexOf("+1")?this.props.current.phone.substr(2):this.props.current.phone.substr(3),t}return e}},{key:"setPrefix",value:function(e){var t="";return""!==e&&e?(t=0===e.indexOf("+1")?"+1":this.props.current.phone.substr(0,3),t):t}},{key:"render",value:function(){console.log("Value . "+this.state.value);var e={required:"${label} is required!",types:{email:"${label} is not validate email!",number:"${label} is not a validate number!"},number:{range:"${label} must be between ${min} and ${max}"}},t=C["a"].Option,a=void 0!=this.props.data?this.props.data.map((function(e){return b.a.createElement(t,{key:null!=e.orgname?e.text:"",value:e["mcp-1-pk"]},e.orgname)})):"",n=this.props.current;return console.log("Current User "+JSON.stringify(n)),b.a.createElement(f["a"],{closable:!0,visible:this.props.visible,title:"User Details",footer:null,destroyOnClose:!0,onCancel:this.props.onCancel},b.a.createElement(O["a"],{labelCol:{xs:{span:24},sm:{span:10}},wrapperCol:{xs:{span:24},sm:{span:16}},onFinish:this.onFinish,validateMessages:e,initialValues:Object(r["a"])({prefix:"91",orgid:this.props.current.id_organization,role:this.props.current.role,name:this.props.current.name,email:this.props.current.email,phoneNumber:this.setPhone(this.props.current.phone)},"prefix",this.setPrefix(this.props.current.phone))},b.a.createElement(O["a"].Item,{label:"CompanyName",name:"orgid",hasFeedback:this.state.loadingcompanies,rules:[{required:!0}]},b.a.createElement(C["a"],{disabled:!0,required:!0,showSearch:!0,value:this.state.value,placeholder:"companyName",style:{width:"100%"},defaultActiveFirstOption:!1,showArrow:!1,filterOption:function(e,t){return t.value.toLowerCase().indexOf(e.toLowerCase())>=0},onSearch:this.handleSearch,onChange:this.handleChange,notFoundContent:null},a)),b.a.createElement(O["a"].Item,{name:"role",label:"Role",rules:[{required:!0}]},b.a.createElement(C["a"],{placeholder:"Select a role",disabled:!0,onChange:this.onRoleChange,allowClear:!0},b.a.createElement(t,{value:"6"},"User"),b.a.createElement(t,{value:"2"},"Admin Messagin App"),b.a.createElement(t,{value:"3"},"OrgAdmin"),b.a.createElement(t,{value:"5"},"OrgApprover"))),b.a.createElement(O["a"].Item,{label:"Contact Name",name:"name",rules:[{required:!0}]},b.a.createElement(u["a"],{disabled:!0,placeholder:"Contact Name",id:"error"})),b.a.createElement(O["a"].Item,{label:"Contact Email",name:"email",rules:[{required:!0,type:"email"}]},b.a.createElement(u["a"],{disabled:!0,placeholder:"Contact Email",id:"error"})),b.a.createElement(O["a"].Item,{label:"Contact Number",name:"phoneNumber",rules:[{required:!0}]},b.a.createElement(u["a"],{disabled:!0,addonBefore:this.prefixSelector,placeholder:"Contact Number"})),b.a.createElement(O["a"].Item,{wrapperCol:{span:12,offset:6}})))}}]),a}(v["Component"])),N=x,z=a("9kvl"),j=a("WG1l"),R=a.n(j),q=a("l+S1"),D=a("9BLJ"),F=a("/MfK"),P=f["a"].confirm,T=function(e){Object(h["a"])(a,e);var t=Object(g["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),r.deleteUser=function(e){console.log("continue");var t=Object(m["a"])(r);P({title:"Confirm",content:"Are you sure to delete this user?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){console.log("OK"),t.props.dispatch({type:"organization/deleteUser",payload:{method:"deleteUserOrganization",id_user:e.id,id_organization:e.id_organization,role:e.role}})},onCancel:function(){console.log("Cancel")}})},r.onCancel=function(){r.setState({formvalues:[],type:"",visible:!1,visibleedituser:!1})},r.onOk=function(){r.setState({visible:!1})},r.editUser=function(e){console.log("Candiate "+JSON.stringify(e)),r.setState({formvalues:e,typeofuser:"edit",visibleedituser:!0,currentcandidate:e})},r.sendLogin=function(e){},r.updateUser=function(e){r.props.dispatch({type:"organization/updateUserDetails",payload:e}),r.setState({visibleedituser:!1,current:""})},r.createUser=function(e){console.log("Create Data "+JSON.stringify(e));var t=r.state.data,a=t,n={method:"saveUserByOrg",record:e};r.props.dispatch({type:"organization/generateOrgUser",payload:n,role:e.role}),r.setState({data:a,visible:!1,updatedata:!0})},r.getColumnSearchProps=function(e){return{filterDropdown:function(t){var a=t.setSelectedKeys,n=t.selectedKeys,o=t.confirm,l=t.clearFilters;return b.a.createElement("div",{style:{padding:8}},b.a.createElement(u["a"],{ref:function(e){r.searchInput=e},icon:b.a.createElement(q["a"],null),placeholder:"Search ".concat(e),value:n[0],onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(){return r.handleSearch(n,o,e)},style:{width:188,marginBottom:8,display:"block"}}),b.a.createElement(i["b"],null,b.a.createElement(c["a"],{type:"primary",onClick:function(){return r.handleSearch(n,o,e)},icon:b.a.createElement(q["a"],null),size:"small",style:{width:90}},"Search"),b.a.createElement(c["a"],{onClick:function(){return r.handleReset(l)},size:"small",style:{width:90}},"Reset")))},filterIcon:function(e){return b.a.createElement(q["a"],{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return r.searchInput.select()}))},render:function(t){return r.state.searchedColumn===e?b.a.createElement(R.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[r.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}}},r.handleSearch=function(e,t,a){t(),r.setState({searchText:e[0],searchedColumn:a})},r.handleReset=function(e){e(),r.setState({searchText:""})},r.deleteSiteAdmin=function(){var e=r.props.userslist,t=[];e.map((function(e){"SiteAdmin"!==e.role&&t.push(e)})),console.log(t),r.setState({userslist:t})},r.state={visible:!1,loading:!1,visibleedituser:!1,currentcandidate:[],updatedata:!1,typeofuser:"create",formvalues:[],searchText:"",searchedColumn:"",loadedUsers:!1},r}return Object(d["a"])(a,[{key:"componentWillReceiveProps",value:function(){console.log("Component will componentWillReceiveProps")}},{key:"componentDidMount",value:function(){console.log("Component componentWillReceiveProps mount")}},{key:"componentWillMount",value:function(){console.log("Component will mount"),"orgadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getUsersByOrgs",payload:{orgid:localStorage.getItem("orgid"),role:localStorage.getItem("currentAuth")}}),"siteadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getAllUser",payload:[]}),this.props.dispatch({type:"organization/getAllOrgs",payload:[]})}},{key:"componentWillReceiveProps",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,a=t.statusorgadmincreation,r=t.deleteuserstatus,i=t.updateuserstatus;0==i.success&&(s["b"].error(i.log.message),this.props.dispatch({type:"organization/resetUpdateUserDetailsStatus",payload:[]})),1==i.success&&(s["b"].success("User information updated!"),this.props.dispatch({type:"organization/resetUpdateUserDetailsStatus",payload:[]}),"orgadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getUsersByOrgs",payload:{orgid:localStorage.getItem("orgid"),role:localStorage.getItem("currentAuth")}}),"siteadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getAllUser",payload:[]})),r&&(0==r.error&&(s["b"].success("User Deleted Successfully!"),"orgadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getUsersByOrgs",payload:{orgid:localStorage.getItem("orgid"),role:localStorage.getItem("currentAuth")}}),"siteadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getAllUser",payload:[]})),1==r.error&&(s["b"].error(r.message),this.props.dispatch({type:"organization/resetDeleteUserStatus",payload:[]}))),a&&(!1===a.error&&(s["b"].success(a.message,2),"orgadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getUsersByOrgs",payload:{orgid:localStorage.getItem("orgid"),role:localStorage.getItem("currentAuth")}}),"siteadmin"===localStorage.getItem("currentAuth")&&this.props.dispatch({type:"organization/getAllUser",payload:[]})),!0===a.error&&(s["b"].error(a.message,2),this.props.dispatch({type:"organization/resetStatus",payload:[]})));var u=[{title:"Name",dataIndex:"name",key:"name",render:function(e){return b.a.createElement("span",null,void 0!=e?e:"")}},{title:"Role",dataIndex:"role",key:"role",render:function(e){switch(e){case"2":return"Site Admin";case"3":return"Org Admin";case"5":return"Approver";case"6":return"User";default:return e}}},{title:"Email",dataIndex:"email",key:"email"},{title:"Action",key:"action",render:function(t){return b.a.createElement("div",{style:{textAlign:"left"}},b.a.createElement("a",{onClick:function(){return e.editUser(t)}},b.a.createElement(D["a"],null)," Details"),b.a.createElement("p",null),b.a.createElement("a",{disabled:"2"===t.role,onClick:function(){return e.deleteUser(t)}},b.a.createElement(F["a"],null)," Delete"),b.a.createElement("p",null))}}],p=this.state,d=(p.currentcandidate,p.loadedUsers),m=this.props,h=(m.orgadmins,m.userslist);return h&&!d&&this.setState({loadedUsers:!0},(function(t,a){console.log("org"),e.deleteSiteAdmin()})),console.log("Orgs list "+this.props.orgslist),b.a.createElement(n["a"],{spinning:this.props.loading,message:"loading please wait"},b.a.createElement(o["a"],{title:"Manage Organization Users",extra:b.a.createElement(c["a"],{onClick:function(){e.setState({typeofuser:"create",visible:!0})}},"Create User")},b.a.createElement(l["a"],{columns:u,dataSource:this.props.userslist}),b.a.createElement(A,{visible:this.state.visible,onCancel:this.onCancel,onOk:this.onOk,createUser:this.createUser,data:this.props.orgslist}),b.a.createElement(N,{visible:this.state.visibleedituser,onCancel:this.onCancel,onOk:this.onOk,updateUser:this.updateUser,data:this.props.orgslist,current:this.state.currentcandidate})))}}]),a}(v["Component"]);t["default"]=Object(z["b"])((function(e){var t,a=e.organization,n=e.loading;return t={organization:a,statusorgadmincreation:a.statusorgadmincreation,orgslist:a.orgslist,userslist:a.userslist,loading:n.models.organization,deleteuserstatus:a.deleteuserstatus},Object(r["a"])(t,"statusorgadmincreation",a.statusorgadmincreation),Object(r["a"])(t,"updateuserstatus",a.updateuserstatus),Object(r["a"])(t,"orgsusers",a.orgsusers),t}))(T)}}]);